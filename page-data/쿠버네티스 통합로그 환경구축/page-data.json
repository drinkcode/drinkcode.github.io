{
    "componentChunkName": "component---src-templates-markdown-template-tsx",
    "path": "/쿠버네티스 통합로그 환경구축",
    "result": {"data":{"allMarkdownRemark":{"edges":[{"node":{"frontmatter":{"title":"쿠버네티스 통합로그 환경구축","tags":["쿠버네티스"],"created":"2021-12-28T09:26:20.529Z","modified":"2021-12-28T09:42:03.503Z"},"internal":{"content":"\n![쿠버네티스 통합로그 환경구축](./images/쿠버네티스%20통합로그%20환경구축.jpeg)\n\n# 쿠버네티스 통합로그 환경구축\n\n## 프로메테우스 설치\n\nhelm에 stable repo 추가\n\n```bash\nhelm repo add stable https://charts.helm.sh/stable\n```\n\n```bash\nhelm search repo stable\n```\n\n```bash\nhelm repo update\n```\n\n```bash\nhelm install monitor stable/prometheus\n```\n\n```bash\n# 삭제\nhelm uninstall stable/prometheus\n```\n\n```bash\n# 내부구성보기\nhelm inspect values stable/prometheus\n```\n\n```bash\nkubectl get pod\n```\n\n```bash\nkubectl get svc\n```\n\n```bash\n# ClusterIP를 NodePort로 변경\nkubectl edit svc monitor-prometheus-server\n```\n\n![](./images/Clipboard_2021-10-06-11-38-53.png)\n\n---\n\n## install 했지만 pod가 pending상태일 때\n\n```\n$ kubectl get pod\n```\n\n![](./images/Clipboard_2021-10-06-11-57-01.png)\n\n몇 개의 pod이**Pending**상태입니다.\n\n이유는 k8s클러스터에 StorageClass가 정의되어있지 않기 때문입니다.\n(pvc의 요청을 받아줄 provisioner가 없기 때문)\n\n그래서 일단 pv옵션을 false로 변경해주어 EmptyDir을 사용하게 해야 합니다.\n\nHelm chart의 설정을 변경하는 방법은 크게 두가지 방법이 있습니다.\n\n## using yaml\n\n문제가 되는 chart를 먼저 확인해봅시다.\n\n```\n$ helm inspect values stable/prometheus\n```\n\n![](./images/Clipboard_2021-10-06-11-57-21.png)\n\npersistentVolume.enabled가True입니다. 이렇게 표기되어있는 부분이 총 세군데가 있습니다.\n\n수정할 부분만 따로 파일을 만들어주면 됩니다.\n\n```\n$ vim volumeF.yaml\nalertmanager: persistentVolume: enabled: false server: persistentVolume: enabled: false pushgateway:\npersistentVolume: enabled: false\n\n업그레이드해줍시다.\n\n$ helm upgrade -f volumeF.yaml monitor stable/prometheus\n\n업그레이드 하게되면 Pending이었던 pod들이 Running상태로 변하는 것을 확인할 수 있습니다.\n```\n\n![](./images/Clipboard_2021-10-06-11-57-44.png)\n\n## using Command\n\n다른 방법으로는 커맨드라인으로 설정을 추가해주는 방법이 있습니다.\n\nouter: inner: value\n\n위와 같은 표현식을 다음과 같이 표현할 수 있습니다.\n\n```\n$ --set outer.inner=value\n\n그럼 위 문제와 같은 경우는 다음과 같이 표현될 수 있습니다.\n\n$ helm install monitor stable/prometheus --set alertmanager.persistentVolume.enabled=false --set\n  server.persistentVolume.enabled=false --set pushgateway.persistentVolume.enabled=false\n\npod들이 정상적으로 Running되었으니 웹으로 접속해봅시다.\n$ kubectl get svc\n```\n\n## Reference\n\n[helm으로 프로메테우스 설치](https://tommypagy.tistory.com/187)\n"},"html":"<p><img src=\"./images/%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%20%ED%86%B5%ED%95%A9%EB%A1%9C%EA%B7%B8%20%ED%99%98%EA%B2%BD%EA%B5%AC%EC%B6%95.jpeg\" alt=\"쿠버네티스 통합로그 환경구축\"></p>\n<h1 id=\"쿠버네티스-통합로그-환경구축\" style=\"position:relative;\"><a href=\"#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%86%B5%ED%95%A9%EB%A1%9C%EA%B7%B8-%ED%99%98%EA%B2%BD%EA%B5%AC%EC%B6%95\" aria-label=\"쿠버네티스 통합로그 환경구축 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>쿠버네티스 통합로그 환경구축</h1>\n<h2 id=\"프로메테우스-설치\" style=\"position:relative;\"><a href=\"#%ED%94%84%EB%A1%9C%EB%A9%94%ED%85%8C%EC%9A%B0%EC%8A%A4-%EC%84%A4%EC%B9%98\" aria-label=\"프로메테우스 설치 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>프로메테우스 설치</h2>\n<p>helm에 stable repo 추가</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">helm repo <span class=\"token function\">add</span> stable https://charts.helm.sh/stable</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">helm search repo stable</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">helm repo update</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">helm <span class=\"token function\">install</span> monitor stable/prometheus</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 삭제</span>\nhelm uninstall stable/prometheus</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 내부구성보기</span>\nhelm inspect values stable/prometheus</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get pod</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get svc</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ClusterIP를 NodePort로 변경</span>\nkubectl edit svc monitor-prometheus-server</code></pre></div>\n<p><img src=\"./images/Clipboard_2021-10-06-11-38-53.png\" alt=\"\"></p>\n<hr>\n<h2 id=\"install-했지만-pod가-pending상태일-때\" style=\"position:relative;\"><a href=\"#install-%ED%96%88%EC%A7%80%EB%A7%8C-pod%EA%B0%80-pending%EC%83%81%ED%83%9C%EC%9D%BC-%EB%95%8C\" aria-label=\"install 했지만 pod가 pending상태일 때 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>install 했지만 pod가 pending상태일 때</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ kubectl get pod</code></pre></div>\n<p><img src=\"./images/Clipboard_2021-10-06-11-57-01.png\" alt=\"\"></p>\n<p>몇 개의 pod이<strong>Pending</strong>상태입니다.</p>\n<p>이유는 k8s클러스터에 StorageClass가 정의되어있지 않기 때문입니다.\n(pvc의 요청을 받아줄 provisioner가 없기 때문)</p>\n<p>그래서 일단 pv옵션을 false로 변경해주어 EmptyDir을 사용하게 해야 합니다.</p>\n<p>Helm chart의 설정을 변경하는 방법은 크게 두가지 방법이 있습니다.</p>\n<h2 id=\"using-yaml\" style=\"position:relative;\"><a href=\"#using-yaml\" aria-label=\"using yaml permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>using yaml</h2>\n<p>문제가 되는 chart를 먼저 확인해봅시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ helm inspect values stable/prometheus</code></pre></div>\n<p><img src=\"./images/Clipboard_2021-10-06-11-57-21.png\" alt=\"\"></p>\n<p>persistentVolume.enabled가True입니다. 이렇게 표기되어있는 부분이 총 세군데가 있습니다.</p>\n<p>수정할 부분만 따로 파일을 만들어주면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ vim volumeF.yaml\nalertmanager: persistentVolume: enabled: false server: persistentVolume: enabled: false pushgateway:\npersistentVolume: enabled: false\n\n업그레이드해줍시다.\n\n$ helm upgrade -f volumeF.yaml monitor stable/prometheus\n\n업그레이드 하게되면 Pending이었던 pod들이 Running상태로 변하는 것을 확인할 수 있습니다.</code></pre></div>\n<p><img src=\"./images/Clipboard_2021-10-06-11-57-44.png\" alt=\"\"></p>\n<h2 id=\"using-command\" style=\"position:relative;\"><a href=\"#using-command\" aria-label=\"using command permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>using Command</h2>\n<p>다른 방법으로는 커맨드라인으로 설정을 추가해주는 방법이 있습니다.</p>\n<p>outer: inner: value</p>\n<p>위와 같은 표현식을 다음과 같이 표현할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ --set outer.inner=value\n\n그럼 위 문제와 같은 경우는 다음과 같이 표현될 수 있습니다.\n\n$ helm install monitor stable/prometheus --set alertmanager.persistentVolume.enabled=false --set\n  server.persistentVolume.enabled=false --set pushgateway.persistentVolume.enabled=false\n\npod들이 정상적으로 Running되었으니 웹으로 접속해봅시다.\n$ kubectl get svc</code></pre></div>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<p><a href=\"https://tommypagy.tistory.com/187\">helm으로 프로메테우스 설치</a></p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%86%B5%ED%95%A9%EB%A1%9C%EA%B7%B8-%ED%99%98%EA%B2%BD%EA%B5%AC%EC%B6%95\">쿠버네티스 통합로그 환경구축</a></p>\n<ul>\n<li><a href=\"#%ED%94%84%EB%A1%9C%EB%A9%94%ED%85%8C%EC%9A%B0%EC%8A%A4-%EC%84%A4%EC%B9%98\">프로메테우스 설치</a></li>\n<li><a href=\"#install-%ED%96%88%EC%A7%80%EB%A7%8C-pod%EA%B0%80-pending%EC%83%81%ED%83%9C%EC%9D%BC-%EB%95%8C\">install 했지만 pod가 pending상태일 때</a></li>\n<li><a href=\"#using-yaml\">using yaml</a></li>\n<li><a href=\"#using-command\">using Command</a></li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n</li>\n</ul>"}}]},"allFile":{"nodes":[{"base":"random3.jpeg","absolutePath":"/Users/tdlab/Dropbox/athi_ts/static/randomImg/random3.jpeg"},{"base":"random2.jpeg","absolutePath":"/Users/tdlab/Dropbox/athi_ts/static/randomImg/random2.jpeg"},{"base":"random4.jpeg","absolutePath":"/Users/tdlab/Dropbox/athi_ts/static/randomImg/random4.jpeg"},{"base":"random1.jpeg","absolutePath":"/Users/tdlab/Dropbox/athi_ts/static/randomImg/random1.jpeg"}]}},"pageContext":{"title":"쿠버네티스 통합로그 환경구축"}},
    "staticQueryHashes": []}